{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nconst TaskMerger = {\n  hasNewInfo(task, tasksWithTopic) {\n    let haveBlock = false;\n    let isWantBlock = false;\n\n    for (const existing of tasksWithTopic) {\n      if (existing.data.haveBlock) {\n        haveBlock = true;\n      }\n\n      if (existing.data.isWantBlock) {\n        isWantBlock = true;\n      }\n    }\n\n    if (!isWantBlock && task.data.isWantBlock) {\n      return true;\n    }\n\n    if (!haveBlock && task.data.haveBlock) {\n      return true;\n    }\n\n    return false;\n  },\n\n  merge(newTask, existingTask) {\n    const taskData = newTask.data;\n    const existingData = existingTask.data;\n\n    if (!existingData.haveBlock && taskData.haveBlock) {\n      existingData.haveBlock = taskData.haveBlock;\n      existingData.blockSize = taskData.blockSize;\n    }\n\n    if (!existingData.isWantBlock && taskData.isWantBlock) {\n      existingData.isWantBlock = true;\n\n      if (!existingData.haveBlock || taskData.haveBlock) {\n        existingData.haveBlock = taskData.haveBlock;\n        existingTask.size = newTask.size;\n      }\n    }\n\n    if (existingData.isWantBlock && existingData.haveBlock) {\n      existingTask.size = existingData.blockSize;\n    }\n  }\n\n};\nexports.TaskMerger = TaskMerger;","map":{"version":3,"sources":["/Users/emilsharafutdinov/Desktop/Work/SR3/Wrdl3/client/node_modules/ipfs-bitswap/cjs/src/decision-engine/task-merger.js"],"names":["Object","defineProperty","exports","value","TaskMerger","hasNewInfo","task","tasksWithTopic","haveBlock","isWantBlock","existing","data","merge","newTask","existingTask","taskData","existingData","blockSize","size"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AAEA,MAAMC,UAAU,GAAG;AACjBC,EAAAA,UAAU,CAACC,IAAD,EAAOC,cAAP,EAAuB;AAC/B,QAAIC,SAAS,GAAG,KAAhB;AACA,QAAIC,WAAW,GAAG,KAAlB;;AACA,SAAK,MAAMC,QAAX,IAAuBH,cAAvB,EAAuC;AACrC,UAAIG,QAAQ,CAACC,IAAT,CAAcH,SAAlB,EAA6B;AAC3BA,QAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,UAAIE,QAAQ,CAACC,IAAT,CAAcF,WAAlB,EAA+B;AAC7BA,QAAAA,WAAW,GAAG,IAAd;AACD;AACF;;AACD,QAAI,CAACA,WAAD,IAAgBH,IAAI,CAACK,IAAL,CAAUF,WAA9B,EAA2C;AACzC,aAAO,IAAP;AACD;;AACD,QAAI,CAACD,SAAD,IAAcF,IAAI,CAACK,IAAL,CAAUH,SAA5B,EAAuC;AACrC,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAnBgB;;AAoBjBI,EAAAA,KAAK,CAACC,OAAD,EAAUC,YAAV,EAAwB;AAC3B,UAAMC,QAAQ,GAAGF,OAAO,CAACF,IAAzB;AACA,UAAMK,YAAY,GAAGF,YAAY,CAACH,IAAlC;;AACA,QAAI,CAACK,YAAY,CAACR,SAAd,IAA2BO,QAAQ,CAACP,SAAxC,EAAmD;AACjDQ,MAAAA,YAAY,CAACR,SAAb,GAAyBO,QAAQ,CAACP,SAAlC;AACAQ,MAAAA,YAAY,CAACC,SAAb,GAAyBF,QAAQ,CAACE,SAAlC;AACD;;AACD,QAAI,CAACD,YAAY,CAACP,WAAd,IAA6BM,QAAQ,CAACN,WAA1C,EAAuD;AACrDO,MAAAA,YAAY,CAACP,WAAb,GAA2B,IAA3B;;AACA,UAAI,CAACO,YAAY,CAACR,SAAd,IAA2BO,QAAQ,CAACP,SAAxC,EAAmD;AACjDQ,QAAAA,YAAY,CAACR,SAAb,GAAyBO,QAAQ,CAACP,SAAlC;AACAM,QAAAA,YAAY,CAACI,IAAb,GAAoBL,OAAO,CAACK,IAA5B;AACD;AACF;;AACD,QAAIF,YAAY,CAACP,WAAb,IAA4BO,YAAY,CAACR,SAA7C,EAAwD;AACtDM,MAAAA,YAAY,CAACI,IAAb,GAAoBF,YAAY,CAACC,SAAjC;AACD;AACF;;AArCgB,CAAnB;AAwCAf,OAAO,CAACE,UAAR,GAAqBA,UAArB","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst TaskMerger = {\n  hasNewInfo(task, tasksWithTopic) {\n    let haveBlock = false;\n    let isWantBlock = false;\n    for (const existing of tasksWithTopic) {\n      if (existing.data.haveBlock) {\n        haveBlock = true;\n      }\n      if (existing.data.isWantBlock) {\n        isWantBlock = true;\n      }\n    }\n    if (!isWantBlock && task.data.isWantBlock) {\n      return true;\n    }\n    if (!haveBlock && task.data.haveBlock) {\n      return true;\n    }\n    return false;\n  },\n  merge(newTask, existingTask) {\n    const taskData = newTask.data;\n    const existingData = existingTask.data;\n    if (!existingData.haveBlock && taskData.haveBlock) {\n      existingData.haveBlock = taskData.haveBlock;\n      existingData.blockSize = taskData.blockSize;\n    }\n    if (!existingData.isWantBlock && taskData.isWantBlock) {\n      existingData.isWantBlock = true;\n      if (!existingData.haveBlock || taskData.haveBlock) {\n        existingData.haveBlock = taskData.haveBlock;\n        existingTask.size = newTask.size;\n      }\n    }\n    if (existingData.isWantBlock && existingData.haveBlock) {\n      existingTask.size = existingData.blockSize;\n    }\n  }\n};\n\nexports.TaskMerger = TaskMerger;\n"]},"metadata":{},"sourceType":"script"}