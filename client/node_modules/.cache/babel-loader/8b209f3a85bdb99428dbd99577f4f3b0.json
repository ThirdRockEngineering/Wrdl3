{"ast":null,"code":"'use strict';\n\nconst {\n  AbstractIterator\n} = require('abstract-leveldown');\n\nconst inherits = require('inherits');\n\nconst getCallback = require('./util').getCallback;\n\nconst kOptions = Symbol('options');\nconst kIterator = Symbol('iterator');\nconst kOperations = Symbol('operations');\nconst kPromise = Symbol('promise');\n\nfunction DeferredIterator(db, options) {\n  AbstractIterator.call(this, db);\n  this[kOptions] = options;\n  this[kIterator] = null;\n  this[kOperations] = [];\n}\n\ninherits(DeferredIterator, AbstractIterator);\n\nDeferredIterator.prototype.setDb = function (db) {\n  this[kIterator] = db.iterator(this[kOptions]);\n\n  for (const op of this[kOperations].splice(0, this[kOperations].length)) {\n    this[kIterator][op.method](...op.args);\n  }\n};\n\nDeferredIterator.prototype.next = function () {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  if (this.db.status === 'open') {\n    return this[kIterator].next(...args);\n  }\n\n  const callback = getCallback(args, kPromise, function map(key, value) {\n    if (key === undefined && value === undefined) {\n      return undefined;\n    } else {\n      return [key, value];\n    }\n  });\n\n  if (this.db.status === 'opening') {\n    this[kOperations].push({\n      method: 'next',\n      args\n    });\n  } else {\n    this._nextTick(callback, new Error('Database is not open'));\n  }\n\n  return callback[kPromise] || this;\n};\n\nDeferredIterator.prototype.seek = function () {\n  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    args[_key2] = arguments[_key2];\n  }\n\n  if (this.db.status === 'open') {\n    this[kIterator].seek(...args);\n  } else if (this.db.status === 'opening') {\n    this[kOperations].push({\n      method: 'seek',\n      args\n    });\n  } else {\n    throw new Error('Database is not open');\n  }\n};\n\nDeferredIterator.prototype.end = function () {\n  for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n    args[_key3] = arguments[_key3];\n  }\n\n  if (this.db.status === 'open') {\n    return this[kIterator].end(...args);\n  }\n\n  const callback = getCallback(args, kPromise);\n\n  if (this.db.status === 'opening') {\n    this[kOperations].push({\n      method: 'end',\n      args\n    });\n  } else {\n    this._nextTick(callback, new Error('Database is not open'));\n  }\n\n  return callback[kPromise] || this;\n};\n\nfor (const method of ['next', 'seek', 'end']) {\n  DeferredIterator.prototype['_' + method] = function () {\n    /* istanbul ignore next: assertion */\n    throw new Error('Did not expect private method to be called: ' + method);\n  };\n}\n\nmodule.exports = DeferredIterator;","map":{"version":3,"sources":["/Users/emilsharafutdinov/Desktop/Work/SR3/Wrdl3/client/node_modules/deferred-leveldown/deferred-iterator.js"],"names":["AbstractIterator","require","inherits","getCallback","kOptions","Symbol","kIterator","kOperations","kPromise","DeferredIterator","db","options","call","prototype","setDb","iterator","op","splice","length","method","args","next","status","callback","map","key","value","undefined","push","_nextTick","Error","seek","end","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nconst { AbstractIterator } = require('abstract-leveldown')\nconst inherits = require('inherits')\nconst getCallback = require('./util').getCallback\n\nconst kOptions = Symbol('options')\nconst kIterator = Symbol('iterator')\nconst kOperations = Symbol('operations')\nconst kPromise = Symbol('promise')\n\nfunction DeferredIterator (db, options) {\n  AbstractIterator.call(this, db)\n\n  this[kOptions] = options\n  this[kIterator] = null\n  this[kOperations] = []\n}\n\ninherits(DeferredIterator, AbstractIterator)\n\nDeferredIterator.prototype.setDb = function (db) {\n  this[kIterator] = db.iterator(this[kOptions])\n\n  for (const op of this[kOperations].splice(0, this[kOperations].length)) {\n    this[kIterator][op.method](...op.args)\n  }\n}\n\nDeferredIterator.prototype.next = function (...args) {\n  if (this.db.status === 'open') {\n    return this[kIterator].next(...args)\n  }\n\n  const callback = getCallback(args, kPromise, function map (key, value) {\n    if (key === undefined && value === undefined) {\n      return undefined\n    } else {\n      return [key, value]\n    }\n  })\n\n  if (this.db.status === 'opening') {\n    this[kOperations].push({ method: 'next', args })\n  } else {\n    this._nextTick(callback, new Error('Database is not open'))\n  }\n\n  return callback[kPromise] || this\n}\n\nDeferredIterator.prototype.seek = function (...args) {\n  if (this.db.status === 'open') {\n    this[kIterator].seek(...args)\n  } else if (this.db.status === 'opening') {\n    this[kOperations].push({ method: 'seek', args })\n  } else {\n    throw new Error('Database is not open')\n  }\n}\n\nDeferredIterator.prototype.end = function (...args) {\n  if (this.db.status === 'open') {\n    return this[kIterator].end(...args)\n  }\n\n  const callback = getCallback(args, kPromise)\n\n  if (this.db.status === 'opening') {\n    this[kOperations].push({ method: 'end', args })\n  } else {\n    this._nextTick(callback, new Error('Database is not open'))\n  }\n\n  return callback[kPromise] || this\n}\n\nfor (const method of ['next', 'seek', 'end']) {\n  DeferredIterator.prototype['_' + method] = function () {\n    /* istanbul ignore next: assertion */\n    throw new Error('Did not expect private method to be called: ' + method)\n  }\n}\n\nmodule.exports = DeferredIterator\n"]},"metadata":{},"sourceType":"script"}